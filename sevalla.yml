# Sevalla deployment configuration for Pipecat Bot
# https://docs.sevalla.com/deployment/configuration

# Build settings
build:
  dockerfile: Dockerfile
  context: .

# Runtime settings
runtime:
  type: docker

# Environment variables
environment:
  - name: PYTHONPATH
    value: "/app"
  - name: PYTHONUNBUFFERED
    value: "1"
  - name: WORKERS
    value: "2"

# Secrets (configure these in Sevalla dashboard)
# DEEPGRAM_API_KEY
# OPENAI_API_KEY
# CARTESIA_API_KEY

# Health check
healthcheck:
  path: "/health"
  interval: 10s
  timeout: 5s
  start_period: 30s
  retries: 3

# Resource allocation (adjust based on load)
resources:
  cpu: "2"
  memory: "4GB"

# Scaling configuration
scaling:
  min_instances: 1
  max_instances: 3
  target_cpu_utilization: 70
  target_memory_utilization: 80

# Port configuration - use environment PORT variable
ports:
  - port: 8080
    protocol: http

# Domains and routing
routes:
  - path: "/"
    port: 8080
  - path: "/client"
    port: 8080
  - path: "/api/*"
    port: 8080
  - path: "/health"
    port: 8080
